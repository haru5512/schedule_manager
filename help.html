<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æº è¨­å®šã‚¬ã‚¤ãƒ‰</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --forest: #2E5C55;
            --soil: #8B5E3C;
            --cream: #FDFBF7;
            --moss: #A3B18A;
        }

        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: var(--cream);
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        h1 {
            font-family: 'Shippori Mincho', serif;
            color: var(--forest);
            text-align: center;
            border-bottom: 2px solid var(--forest);
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        h2 {
            color: var(--soil);
            border-left: 5px solid var(--moss);
            padding-left: 15px;
            margin-top: 40px;
            background: #fafafa;
            padding: 10px 15px;
            border-radius: 0 8px 8px 0;
        }

        .step-num {
            display: inline-block;
            background: var(--forest);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 10px;
            font-size: 14px;
        }

        ol {
            padding-left: 20px;
        }

        li {
            margin-bottom: 10px;
        }

        pre {
            background: #2d2d2d;
            color: #ccc;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: Consolas, monospace;
            font-size: 13px;
        }

        .copy-btn {
            display: block;
            margin: 10px 0;
            background: var(--forest);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .copy-btn:hover {
            opacity: 0.9;
        }

        .warning {
            background: #fff5f5;
            border: 1px solid #ffcdd2;
            color: #c62828;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }

        .note {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            color: #0d47a1;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .back-link {
            display: block;
            text-align: center;
            margin-top: 40px;
            color: var(--forest);
            text-decoration: none;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>ğŸŒ± Googleé€£æº è¨­å®šã‚¬ã‚¤ãƒ‰</h1>
        <p>ã‚ãªãŸã®æ´»å‹•è¨˜éŒ²ã‚’Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã™ã‚‹ãŸã‚ã®è¨­å®šæ‰‹é †ã§ã™ã€‚<br>ã“ã®ãƒšãƒ¼ã‚¸ã‚’è¦‹ãªãŒã‚‰ã€ãƒ‘ã‚½ã‚³ãƒ³ã§è¨­å®šã‚’é€²ã‚ã¦ãã ã•ã„ã€‚</p>

        <h2>æ‰‹é † 1ï¼šã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®æº–å‚™</h2>
        <ol>
            <li>Googleãƒ‰ãƒ©ã‚¤ãƒ–ãªã©ã§ã€<strong>æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</strong>ã‚’ä½œæˆã—ã¾ã™ã€‚</li>
            <li>åå‰ã¯ä½•ã§ã‚‚OKã§ã™ï¼ˆä¾‹ï¼š<code>æ´»å‹•è¨˜éŒ²DB</code>ï¼‰ã€‚</li>
            <li>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® <strong>ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€ ï¼ ã€ŒApps Scriptã€</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚<br>ï¼ˆåˆ¥ã®ã‚¿ãƒ–ã§ã‚³ãƒ¼ãƒ‰ç·¨é›†ç”»é¢ãŒé–‹ãã¾ã™ï¼‰</li>
        </ol>

        <h2>æ‰‹é † 2ï¼šã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ”ãƒš</h2>
        <ol>
            <li>é–‹ã„ãŸç”»é¢ã«ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆ<code>function myFunction...</code>ï¼‰ã‚’ã™ã¹ã¦æ¶ˆã—ã¾ã™ã€‚</li>
            <li>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ã€è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚</li>
        </ol>

        <button class="copy-btn" onclick="copyCode()">ğŸ“‹ ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹</button>

        <pre id="gas-code">// Google Apps Script Code
// 1. Copy this code into your Google Sheet's Script Editor (Extensions > Apps Script)
// 2. Run the 'setup' function once to create the 'db' sheet.
// 3. Deploy as Web App (Execute as: Me, Who has access: Anyone)

const SHEET_NAME = 'db';

function doGet(e) {
    const sheet = getSheet();
    const data = sheet.getDataRange().getValues();
    const headers = data.shift(); // Remove header row

    // Convert rows to array of objects
    const records = data.map(row => {
        return {
            id: row[0],
            date: formatDate(row[1]),
            time: formatTime(row[2]),
            category: row[3],
            content: row[4],
            place: row[5],
            count: row[6],
            note: row[7],
            excludeFromReport: row[8] // Add new column
        };
    }).filter(r => r.id); // Filter empty rows

    const response = {
        records: records,
        spreadsheetUrl: SpreadsheetApp.getActiveSpreadsheet().getUrl()
    };

    return ContentService.createTextOutput(JSON.stringify(response))
        .setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
    const sheet = getSheet();

    try {
        const jsonString = e.postData.contents;
        const data = JSON.parse(jsonString);

        // Case 1: Parse Voice (Gemini API Proxy)
        if (data.action === 'parseVoice') {
            const result = parseVoiceWithGemini(data.transcript, data.currentDate);
            return ContentService.createTextOutput(JSON.stringify(result))
                .setMimeType(ContentService.MimeType.JSON);
        }

        // Case 2: Import Action
        if (data.action === 'import') {
            const count = importFromCalendar(data.startDate, data.endDate);
            return ContentService.createTextOutput(JSON.stringify({ status: 'success', count: count }))
                .setMimeType(ContentService.MimeType.JSON);
        }

        // Case 3: Sync (Array of records)
        let records = [];
        if (Array.isArray(data)) {
            records = data;
        } else {
            // Fallback if wrapped
            records = data.records || [];
        }

        // Clear and Write
        if (sheet.getLastRow() > 1) {
            sheet.getRange(2, 1, sheet.getLastRow() - 1, sheet.getLastColumn()).clearContent();
        }

        if (records.length > 0) {
            const rows = records.map(r => [
                r.id, r.date, r.time, r.category, r.content, r.place, r.count, r.note, r.excludeFromReport || false
            ]);
            sheet.getRange(2, 1, rows.length, rows[0].length).setValues(rows);
        }

        return ContentService.createTextOutput(JSON.stringify({ status: 'success', count: records.length }))
            .setMimeType(ContentService.MimeType.JSON);

    } catch (err) {
        return ContentService.createTextOutput(JSON.stringify({ status: 'error', message: err.toString() }))
            .setMimeType(ContentService.MimeType.JSON);
    }
}

function importFromCalendar(startStr, endStr) {
    const sheet = getSheet();
    const start = new Date(startStr);
    const end = new Date(endStr);
    // Set end to end of day
    end.setHours(23, 59, 59);

    const events = CalendarApp.getDefaultCalendar().getEvents(start, end);
    const newRows = [];

    events.forEach(e => {
        // Skip all-day events if preferred, or include them. Here we include them.
        const d = e.getStartTime();
        const date = Utilities.formatDate(d, Session.getScriptTimeZone(), 'yyyy-MM-dd');
        const time = e.isAllDayEvent() ? '' : Utilities.formatDate(d, Session.getScriptTimeZone(), 'HH:mm');

        newRows.push([
            Utilities.getUuid(), // Generate ID
            date,
            time,
            'ãã®ä»–', // Default category
            e.getTitle(),
            e.getLocation(),
            '', // count
            e.getDescription()
        ]);
    });

    if (newRows.length > 0) {
        sheet.getRange(sheet.getLastRow() + 1, 1, newRows.length, newRows[0].length).setValues(newRows);
    }
    return newRows.length;
}

/**
 * Parse voice transcription using Gemini API
 * API Key is stored in Script Properties (safer than client-side)
 */
function parseVoiceWithGemini(transcript, currentDateStr) {
    // Get API key from Script Properties
    const apiKey = PropertiesService.getScriptProperties().getProperty('GEMINI_API_KEY');

    if (!apiKey) {
        return {
            status: 'error',
            message: 'Gemini APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\\nGASã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã€ŒGEMINI_API_KEYã€ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚'
        };
    }

    const prompt = `ä»¥ä¸‹ã®éŸ³å£°å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã€æ´»å‹•è¨˜éŒ²ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŠ½å‡ºã—ã¦JSONå½¢å¼ã§è¿”ã—ã¦ãã ã•ã„ã€‚

éŸ³å£°å…¥åŠ›: ${transcript}

ç¾åœ¨ã®æ—¥æ™‚: ${currentDateStr}

æŠ½å‡ºã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:
- date: YYYY/MM/DDå½¢å¼
    - ã€Œä»Šæ—¥ã€ã€Œæ˜æ—¥ã€ã€Œæ˜¨æ—¥ã€ãªã©ã¯ç¾åœ¨ã®æ™‚é–“ã‚’åŸºæº–ã«è¨ˆç®—
    - ã€Œ3æœˆ10æ—¥ã€ã®ã‚ˆã†ã«å¹´ãŒçœç•¥ã•ã‚ŒãŸå ´åˆã¯ã€ç¾åœ¨ã®æ—¥æ™‚ï¼ˆ${currentDateStr}ï¼‰ã¨åŒã˜å¹´ã‚’è£œå®Œ
    - æ—¥ä»˜ã¸ã®è¨€åŠãŒãªã„å ´åˆã¯ã€ç¾åœ¨ã®æ—¥ä»˜ã‚’ä½¿ç”¨
- time: HH:MMå½¢å¼ï¼ˆ24æ™‚é–“è¡¨è¨˜ã€è¨€åŠã•ã‚Œã¦ã„ãªã„å ´åˆã¯ç¾åœ¨ã®æ™‚åˆ»ï¼‰
- category: è¨ªå•/ä¼šè­°/ã‚¤ãƒ™ãƒ³ãƒˆ/è³‡æ–™ä½œæˆ/äº‹å‹™ä½œæ¥­/ãã®ä»– ã®ã„ãšã‚Œã‹ï¼ˆå†…å®¹ã‹ã‚‰æœ€ã‚‚é©åˆ‡ãªã‚‚ã®ã‚’æ¨æ¸¬ï¼‰
- content: æ´»å‹•å†…å®¹ã®ç°¡æ½”ãªèª¬æ˜ï¼ˆ50æ–‡å­—ä»¥å†…ï¼‰
- place: å ´æ‰€ï¼ˆè¨€åŠã•ã‚Œã¦ã„ãªã‘ã‚Œã°ç©ºæ–‡å­—ï¼‰
- count: å‚åŠ äººæ•°ï¼ˆæ•°å€¤ã®ã¿ã€è¨€åŠã•ã‚Œã¦ã„ãªã‘ã‚Œã°0ï¼‰
- note: ãã®ä»–ã®ãƒ¡ãƒ¢ï¼ˆè£œè¶³æƒ…å ±ãŒã‚ã‚Œã°ï¼‰

æ³¨æ„äº‹é …:
- æ—¥ä»˜ã®ç›¸å¯¾è¡¨ç¾ï¼ˆä»Šæ—¥ã€æ˜æ—¥ãªã©ï¼‰ã¯å¿…ãšå…·ä½“çš„ãªæ—¥ä»˜ã«å¤‰æ›ã—ã¦ãã ã•ã„
- ã‚«ãƒ†ã‚´ãƒªã¯å¿…ãšä¸Šè¨˜6ã¤ã®ã„ãšã‚Œã‹ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„
- æ•°å€¤ã¯å¿…ãšæ•°å­—ã®ã¿ã§è¿”ã—ã¦ãã ã•ã„
- JSONã®ã¿ã‚’è¿”ã—ã€èª¬æ˜æ–‡ã¯å«ã‚ãªã„ã§ãã ã•ã„

JSONå½¢å¼:
{
  "date": "YYYY/MM/DD",
  "time": "HH:MM",
  "category": "ã‚«ãƒ†ã‚´ãƒªå",
  "content": "æ´»å‹•å†…å®¹",
  "place": "å ´æ‰€",
  "count": 0,
  "note": "ãƒ¡ãƒ¢"
}`;

    const requestBody = {
        contents: [{
            parts: [{
                text: prompt
            }]
        }]
    };

    try {
        const response = UrlFetchApp.fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`,
            {
                method: 'post',
                contentType: 'application/json',
                payload: JSON.stringify(requestBody),
                muteHttpExceptions: true
            }
        );

        const responseCode = response.getResponseCode();

        if (responseCode !== 200) {
            return {
                status: 'error',
                message: `Gemini API ã‚¨ãƒ©ãƒ¼ (${responseCode}): ${response.getContentText()}`
            };
        }

        const data = JSON.parse(response.getContentText());

        if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
            return {
                status: 'error',
                message: 'è§£æçµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ'
            };
        }

        let text = data.candidates[0].content.parts[0].text.trim();

        // Remove markdown code blocks if present
        if (text.startsWith('```json')) {
            text = text.replace(/```json\n?/g, '').replace(/```\n?/g, '');
        } else if (text.startsWith('```')) {
            text = text.replace(/```\n?/g, '');
        }

        const parsed = JSON.parse(text);

        return {
            status: 'success',
            data: {
                date: parsed.date || '',
                time: parsed.time || '',
                category: parsed.category || '',
                content: parsed.content || transcript,
                place: parsed.place || '',
                count: parseInt(parsed.count) || 0,
                note: parsed.note || ''
            }
        };

    } catch (error) {
        return {
            status: 'error',
            message: `è§£æã‚¨ãƒ©ãƒ¼: ${error.toString()}`
        };
    }
}

function setup() {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    let sheet = ss.getSheetByName(SHEET_NAME);
    if (!sheet) {
        sheet = ss.insertSheet(SHEET_NAME);
        // Add headers
        sheet.appendRow(['id', 'date', 'time', 'category', 'content', 'place', 'count', 'note', 'excludeFromReport']);
        // Format headers
        sheet.getRange(1, 1, 1, 9).setFontWeight('bold').setBackground('#f3f3f3');
        sheet.setFrozenRows(1);
    }
}

function getSheet() {
    return SpreadsheetApp.getActiveSpreadsheet().getSheetByName(SHEET_NAME) || SpreadsheetApp.getActiveSpreadsheet().insertSheet(SHEET_NAME);
}

function formatDate(date) {
    if (!date) return '';
    if (typeof date === 'string') return date;
    return Utilities.formatDate(date, Session.getScriptTimeZone(), 'yyyy-MM-dd');
}

function formatTime(time) {
    if (!time) return '';
    if (typeof time === 'string') return time;
    // If it's a date object (Google Sheets treats time as date sometimes), extract HH:mm
    return Utilities.formatDate(time, Session.getScriptTimeZone(), 'HH:mm');
}</pre>

        <p>è²¼ã‚Šä»˜ã‘ãŸã‚‰ã€ãƒ•ãƒ­ãƒƒãƒ”ãƒ¼ãƒ‡ã‚£ã‚¹ã‚¯ã®ã‚¢ã‚¤ã‚³ãƒ³ğŸ’¾ï¼ˆä¿å­˜ï¼‰ã‚’æŠ¼ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚</p>

        <h2>æ‰‹é † 3ï¼šAPIã‚­ãƒ¼ã®è¨­å®šï¼ˆéŸ³å£°å…¥åŠ›ç”¨ï¼‰</h2>
        <div class="note">
            ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã§ã®éŸ³å£°å…¥åŠ›ï¼ˆAIè§£æï¼‰ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã®ã¿å¿…è¦ã§ã™ã€‚ä¸è¦ãªå ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚
        </div>
        <ol>
            <li>Apps Scriptç”»é¢ã®å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ <strong>ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã€ï¼ˆæ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³âš™ï¸ï¼‰</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
            <li>ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã® <strong>ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€</strong> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
            <li>ä»¥ä¸‹ã®é€šã‚Šã«å…¥åŠ›ã—ã¦ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
                <ul>
                    <li><strong>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</strong>ï¼š<code>GEMINI_API_KEY</code></li>
                    <li><strong>å€¤</strong>ï¼šå–å¾—ã—ãŸGemini APIã‚­ãƒ¼ï¼ˆAI Studioã§å–å¾—ã§ãã¾ã™ï¼‰</li>
                </ul>
            </li>
        </ol>

        <h2>æ‰‹é † 4ï¼šåˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆé‡è¦ï¼‰</h2>
        <p>â€» ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã€<strong>åˆã‚ã¦è¨­å®šã™ã‚‹ã¨ãã¯å¿…ãšå®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong>ï¼ˆã™ã§ã«ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—å¯ï¼‰</p>
        <ol>
            <li>ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã€Œãƒ‡ãƒãƒƒã‚°ã€ã®æ¨ªã«ã‚ã‚‹ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‹ã‚‰ <strong>ã€Œsetupã€</strong> ã‚’é¸ã³ã¾ã™ã€‚</li>
            <li><strong>å®Ÿè¡Œãƒœã‚¿ãƒ³ â–¶</strong> ã‚’æŠ¼ã—ã¾ã™ã€‚</li>
            <li>ã€Œæ‰¿èªãŒå¿…è¦ã§ã™ã€ã¨å‡ºãŸã‚‰ï¼š
                <ul>
                    <li>ã€Œæ¨©é™ã‚’ç¢ºèªã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    <li>è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠ</li>
                    <li>ï¼ˆè­¦å‘ŠãŒå‡ºãŸå ´åˆï¼‰å·¦ä¸‹ã®ã€Œè©³ç´°ã€â†’ã€Œï¼ˆå®‰å…¨ã§ã¯ãªã„ãƒšãƒ¼ã‚¸ï¼‰ã«ç§»å‹•ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    <li><strong>ã€Œè¨±å¯ã€</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
                </ul>
            </li>
            <li>ç”»é¢ä¸‹ã«ã€Œå®Ÿè¡Œå®Œäº†ã€ã¨å‡ºã‚Œã°OKã§ã™ã€‚ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã€Œdbã€ã¨ã„ã†ã‚·ãƒ¼ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚</li>
        </ol>

        <h2>æ‰‹é † 5ï¼šWebã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹ï¼ˆæ›´æ–°ï¼‰</h2>
        <p>â€» ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸã‚‰ã€å¿…ãš <strong>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã®æ›´æ–°ã€ã§ã¯ãªãã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€</strong> ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p>
        <ol>
            <li>å³ä¸Šã® <strong>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ ï¼ ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚</li>
            <li>å·¦ä¸Šã®æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³âš™ï¸ ï¼ <strong>ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€</strong> ã‚’é¸æŠã€‚</li>
            <li>ä»¥ä¸‹ã®é€šã‚Šã«è¨­å®šã—ã¦ãã ã•ã„ï¼ˆã“ã“ãŒé–“é•ãˆã‚„ã™ã„ã§ã™ï¼ï¼‰
                <ul>
                    <li><strong>èª¬æ˜</strong>ï¼š<code>v2 Update</code> ï¼ˆä½•ã§ã‚‚OKï¼‰</li>
                    <li><strong>æ¬¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å®Ÿè¡Œ</strong>ï¼š<strong>ã€Œè‡ªåˆ† (Me)ã€</strong></li>
                    <li class="warning"><strong>ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼</strong>ï¼š<strong>ã€Œå…¨å“¡
                            (Anyone)ã€</strong><br>â€»ã€ŒGoogleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã¤å…¨å“¡ã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ã‚·ãƒ³ãƒ—ãƒ«ãªã€Œå…¨å“¡ã€ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</li>
                </ul>
            </li>
            <li><strong>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚</li>
            <li>ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ <strong>ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã®URL</strong> ï¼ˆ<code>https://script.google.com/...</code>
                ã§å§‹ã¾ã‚‹ã‚‚ã®ï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚<br>â€»ã€Œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®URLã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼</li>
        </ol>

        <h2>æ‰‹é † 6ï¼šã‚¢ãƒ—ãƒªã«æ¥ç¶š</h2>
        <ol>
            <li>ã‚¢ãƒ—ãƒªã®è¨­å®šç”»é¢ã«æˆ»ã‚Šã¾ã™ã€‚</li>
            <li>ã‚³ãƒ”ãƒ¼ã—ãŸURLã‚’è²¼ã‚Šä»˜ã‘ã¦ã€ã€Œä¿å­˜ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</li>
            <li>ã“ã‚Œã§é€£æºå®Œäº†ã§ã™ï¼å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</li>
        </ol>

        <p style="text-align: center; margin-top: 40px;">ã“ã‚Œã§è¨­å®šã¯å®Œäº†ã§ã™ï¼ãŠç–²ã‚Œæ§˜ã§ã—ãŸ ğŸ‰</p>

        <a href="javascript:window.close()" class="back-link">é–‰ã˜ã‚‹</a>
    </div>

    <script>
        function copyCode() {
            const code = document.getElementById('gas-code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                alert('ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼Scriptã‚¨ãƒ‡ã‚£ã‚¿ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
            });
        }
    </script>

</body>

</html>